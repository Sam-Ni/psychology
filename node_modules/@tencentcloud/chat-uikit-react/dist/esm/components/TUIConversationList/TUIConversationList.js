import{__assign as o}from"tslib";import{jsx as t,jsxs as e,Fragment as n}from"react/jsx-runtime";import r,{useState as i,useRef as s}from"react";import a from"tim-js-sdk";import{useTUIKitContext as v}from"../../context/TUIKitContext.js";import"../../context/TUIChatStateContext.js";import"../../context/TUIChatActionContext.js";import"../../context/TUIMessageContext.js";import"../../context/ComponentContext.js";import"../../context/TUIMessageInputContext.js";import c from"./hooks/useConversationList.js";import{ConversationPreview as C}from"../ConversationPreview/ConversationPreview.js";import"../ConversationPreview/ConversationPreviewContent.js";import"../ConversationPreview/MyConversationPreviewContent.js";import{ConversationListContainer as m}from"../ConversationPreview/ConversationListContainer.js";import{Profile as u}from"../Profile/Profile.js";import{ConversationSearchInput as l}from"../ConversationSearch/ConversationSearchInput.js";import{ConversationSearchResult as p}from"../ConversationSearch/ConversationSearchResult.js";import{ConversationCreate as f}from"../ConversationCreate/ConversationCreate.js";import{Icon as d}from"../Icon/Icon.js";import{IconTypes as h}from"../Icon/type.js";import"../Input/Input.js";import"../ConversationCreate/ConversationGroupTypeInfo.js";import{useTUIConversationContext as j}from"../../context/TUIConversationContext.js";import{getDisplayTitle as w}from"../ConversationPreview/utils.js";import{useConversationUpdate as I}from"./hooks/useConversationUpdate.js";function P(r){var P=r.Preview,x=r.Container,U=void 0===x?m:x,T=r.onConversationListUpdated,L=r.filterConversation,g=r.showSelf,y=void 0===g||g,S=r.showSearch,N=void 0===S||S,A=r.onlyGroupConversation,E=void 0!==A&&A,k=r.onlyC2CConversation,O=void 0!==k&&k,R=r.setCurrentConversation,D=v("TUIConversationList"),G=D.tim,M=D.customClasses,V=D.conversation,b=D.setActiveConversation,F=D.setTUIProfileShow,Y=j("TUIConversationList").filterConversation,_=L||Y,K=i(0),q=K[0],z=K[1],B=c(G,(function(o,t){o.length&&b(V)}),_),H=B.conversationList,J=B.setConversationList;I(J,T,(function(){return z((function(o){return o+1}))}),_);var Q=i(""),W=Q[0],X=Q[1],Z=i(H),$=Z[0],oo=Z[1],to=i(!1),eo=to[0],no=to[1],ro=v().myProfile,io=s(null);return t("div",o({className:"tui-conversation ".concat(M||""),ref:io},{children:eo?t(f,{conversationList:H,setConversationCreated:no}):e(n,{children:[y&&t(u,{profile:ro,handleAvatar:function(){F(!0)}}),N&&e("div",o({className:"tui-conversation-header"},{children:[t(l,{value:W,clearable:!0,onChange:function(o){var t,e;if(X(null===(t=o.target)||void 0===t?void 0:t.value),null===(e=o.target)||void 0===e?void 0:e.value){var n=H.filter((function(t){var e;return w(t).toLocaleLowerCase().includes(null===(e=o.target)||void 0===e?void 0:e.value.toLocaleLowerCase())}));oo(n)}else oo([])}}),t("div",o({className:"tui-conversation-create-icon"},{children:t(d,{onClick:function(){X(""),no(!0)},type:h.CREATE,height:24,width:24})}))]})),t(U,o({setConversationList:J},{children:0===H.length?e("div",o({className:"no-result"},{children:[t(d,{className:"no-result-icon",type:h.EFFORT,width:42,height:42}),t("div",o({className:"no-result-message"},{children:"No conversation"}))]})):W?t(p,{Preview:P,searchValue:W,result:$}):E?H.filter((function(o){return o.type===a.TYPES.CONV_GROUP})).map((function(e){return t(C,o({},{activeConversation:V,conversation:e,setActiveConversation:b,Preview:P,conversationUpdateCount:q,setCurrentConversation:R}),e.conversationID)})):O?H.filter((function(o){return o.type===a.TYPES.CONV_C2C})).map((function(e){return t(C,o({},{activeConversation:V,conversation:e,setActiveConversation:b,Preview:P,conversationUpdateCount:q,setCurrentConversation:R}),e.conversationID)})):H.map((function(e){return t(C,o({},{activeConversation:V,conversation:e,setActiveConversation:b,Preview:P,conversationUpdateCount:q,setCurrentConversation:R}),e.conversationID)}))}))]})}))}var x=r.memo(P);export{x as TUIConversationList,P as UnMemoTUIConversationList};
