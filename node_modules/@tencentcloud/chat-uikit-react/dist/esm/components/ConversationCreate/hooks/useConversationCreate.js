import{__awaiter as r,__generator as t}from"tslib";import{useState as e,useEffect as n}from"react";import o from"tim-js-sdk";import{strChineseFirstPy as i}from"../static/word.js";import"../../../context/TUIConversationContext.js";import{useProfile as u}from"../../../hooks/useProfile.js";var c=function(c,s,a){var f=e({}),d=f[0],l=f[1],v=function(r){var t=r.trim(),e=t.charCodeAt(0);return e>40869||e<19968?t.charAt(0):i.charAt(e-19968)},m=function(){return r(void 0,void 0,void 0,(function(){var r,e,n,i,u;return t(this,(function(t){switch(t.label){case 0:return r=s.filter((function(r){return r.type===o.TYPES.CONV_C2C})).slice(0,5).map((function(r){return r.userProfile})),[4,c.getFriendList()];case 1:return e=t.sent(),n=e.code,i=e.data,0===n&&(u=p(i.map((function(r){return r.profile})),r),l(u),a&&a(u,l)),[2]}}))}))},p=function(r,t){void 0===t&&(t=[]);for(var e={"Frequently Contacted":t,"#":[]},n=65;n<=90;n+=1)e[String.fromCharCode(n)]=[];return r.forEach((function(r){var t=r.nick,n=r.userID,o=v(t||n);o>="a"&&o<="z"?e[o.toLocaleUpperCase()].push(r):o<"A"||o>"z"?e["#"].push(r):e[o].push(r)})),Object.keys(e).forEach((function(r){e[r].sort((function(r,t){var e=r.nick,n=r.userID,o=t.nick,i=t.userID;return e||n<o||i||e||n===o||i?1:-1}))})),e},h=u(c).getUserProfile;return n((function(){m()}),[c]),{getFirstLetter:v,queryFriendList:m,getFriendListSortSearchResult:function(e){return r(void 0,void 0,void 0,(function(){var r,n,o,i;return t(this,(function(t){switch(t.label){case 0:return e?[4,h([e])]:[2,d];case 1:return r=t.sent().data,n={},o=!1,Object.keys(d).forEach((function(r){n[r]=d[r].filter((function(r){var t=r.nick,n=r.userID,i=t.toLocaleLowerCase(),u=e.toLocaleLowerCase(),c=i?i.includes(u):n.includes(u);return o=o||c,c}))})),"TencentCloudDemo"===(null===(i=process.env)||void 0===i?void 0:i.REACT_APP_ONLINE)?[2,n]:[2,o?n:p(r)]}}))}))},friendListSortResult:d}};export{c as useConversationCreate};
