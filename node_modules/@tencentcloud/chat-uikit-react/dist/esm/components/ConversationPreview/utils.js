import{__assign as e}from"tslib";import{jsxs as r,jsx as t}from"react/jsx-runtime";import{isThisYear as a,format as o,isToday as s,isYesterday as i,formatDistance as n,isThisWeek as c}from"date-fns";import l from"tim-js-sdk";import"react";import"../Icon/config.js";import"../Icon/type.js";import{defaultGroupAvatarWork as u,defaultUserAvatar as d}from"../Avatar/default.js";import{formatEmojiString as p}from"../TUIMessage/utils/emojiMap.js";var f=function(a,o,s){void 0===s&&(s="#147AFF");var i=v(a),n=i.name,c=i.nick,u=i.groupID,d=i.userID,p="";switch(a.type){case l.TYPES.CONV_C2C:p=c||d;break;case l.TYPES.CONV_GROUP:p=n||u;break;default:p=""}var f,m;return o?(m=(f=p).toLocaleLowerCase().indexOf(o.toLocaleLowerCase()),r("div",{children:[t("span",{children:f.slice(0,m)}),t("span",e({style:{color:s}},{children:f.slice(m,m+o.length)})),t("span",{children:f.slice(m+o.length)})]})):p},m=function(e){var r=e.type,t=v(e).avatar,a=t;if(!t)switch(r){case l.TYPES.CONV_C2C:a=d;break;case l.TYPES.CONV_GROUP:default:a=u}return a},C=function(a,o){var s=a.lastMessage,i=a.type,n=s.fromAccount,c=s.nick,u=s.nameCard,d=s.isRevoked,f="";switch(i){case l.TYPES.CONV_GROUP:f=(null==s?void 0:s.fromAccount)===(null==o?void 0:o.userID)?"You":"".concat(u||c||n||""),f="".concat(f?"".concat(f,":"):"");break;case l.TYPES.CONV_C2C:f=d?"you ":""}return r("div",e({style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{children:[t("span",{children:f}),t("span",{children:s.isRevoked?"recalled a message":p(s.messageForShow,1)})]}))},v=function(e){if(!e)return null;var r={},t=e.type,a=e.groupProfile,o=e.userProfile;switch(t){case l.TYPES.CONV_C2C:r=o;break;case l.TYPES.CONV_GROUP:r=a;case l.TYPES.CONV_SYSTEM:}return r},h=function(e){var r=e.lastMessage;return O(1e3*r.lastTime)},O=function(e){return e?a(e)?s(e)?o(e,"p"):i(e)?n(e,new Date):c(e)?o(e,"eeee"):o(e,"MMM dd"):o(e,"yyyy MMM dd"):""};export{m as getDisplayImage,C as getDisplayMessage,h as getDisplayTime,f as getDisplayTitle,v as getMessageProfile,O as getTimeStamp};
