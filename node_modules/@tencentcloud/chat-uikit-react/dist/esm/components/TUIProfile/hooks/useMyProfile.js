import{__awaiter as t,__generator as n,__assign as e}from"tslib";import{useState as o,useCallback as r,useEffect as i}from"react";import u from"tim-js-sdk";import{useTUIKitContext as c}from"../../../context/TUIKitContext.js";import"../../../context/TUIChatStateContext.js";import"../../../context/TUIChatActionContext.js";import"../../../context/TUIMessageContext.js";import"../../../context/ComponentContext.js";import"../../../context/TUIMessageInputContext.js";function s(){var s=this,a=o(null),l=a[0],f=a[1],m=c("useMyProfile"),d=m.tim,p=m.myProfile,x=r((function(){return t(s,void 0,void 0,(function(){var t;return n(this,(function(n){switch(n.label){case 0:return p?(f(p),[3,3]):[3,1];case 1:return[4,null==d?void 0:d.getMyProfile()];case 2:t=n.sent(),f(null==t?void 0:t.data),n.label=3;case 3:return[2]}}))}))}),[d]),v=r((function(o){return t(s,void 0,void 0,(function(){var t,r;return n(this,(function(n){switch(n.label){case 0:return[4,null==d?void 0:d.updateMyProfile(o)];case 1:return t=n.sent(),r=e({},l),Object.keys(t.data).map((function(n){return r[n]=t.data[n],n})),f(r),[2,t]}}))}))}),[d]),P=function(t){console.log("onProfileUpdated",t.data)};return i((function(){return t(s,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,x()];case 1:return t.sent(),[2]}}))})),null==d||d.on(u.EVENT.PROFILE_UPDATED,P),function(){null==d||d.off(u.EVENT.PROFILE_UPDATED,P)}}),[d]),{myProfile:l,updateMyProfile:v}}export{s as useMyProfile};
