"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),s=require("react/jsx-runtime"),t=require("react"),n=require("tim-js-sdk"),a=require("../../constants.js");require("../../context/TUIKitContext.js"),require("../../context/TUIChatStateContext.js");var i=require("../../context/TUIChatActionContext.js");require("../../context/TUIMessageContext.js"),require("../../context/ComponentContext.js"),require("../../context/TUIMessageInputContext.js");var r=require("../Icon/Icon.js"),l=require("../Icon/type.js"),o=require("./hooks/useMessageReply.js"),u=require("./MessageProgress.js");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var d=c(t),g=c(n);var x=d.default.memo((function(n){var c=n.message,d=n.children,x=n.Context,m=n.Plugins,j=t.useState(!1),b=j[0],S=j[1],_=o.useMessageReply({message:c}),v=_.messageReply,p=_.replyMessage,I=_.sender,M=i.useTUIChatActionContext().setHighlightedMessageId;return s.jsxs("div",e.__assign({className:"meesage-bubble"},{children:[s.jsxs("div",e.__assign({className:"meesage-bubble-context ".concat(null==c?void 0:c.flow),onMouseEnter:function(){S(!0)},onMouseLeave:function(){S(!1)}},{children:[s.jsxs("div",e.__assign({className:"message-context\n            ".concat(v?"meesage-bubble-reply meesage-bubble-reply-".concat(null==c?void 0:c.flow):"","\n            ").concat((null==c?void 0:c.type)!==g.default.TYPES.MSG_IMAGE&&(null==c?void 0:c.type)!==g.default.TYPES.MSG_VIDEO&&(null==c?void 0:c.type)!==g.default.TYPES.MSG_FILE||(null==c?void 0:c.status)!==a.MESSAGE_STATUS.UNSEND?"":"loading")},{children:[v&&s.jsxs("div",e.__assign({className:"meesage-bubble-reply-main",role:"menuitem",tabIndex:0,onClick:function(){M(null==p?void 0:p.ID)}},{children:[s.jsx("header",e.__assign({className:"title"},{children:I})),x&&s.jsx(x,{message:p})]})),d,s.jsx(u.MessageProgress,{message:c})]})),m&&s.jsx("div",e.__assign({className:"message-plugin"},{children:b&&s.jsx(m,{})}))]})),s.jsxs("div",e.__assign({className:"message-bubble-status icon"},{children:[(null==c?void 0:c.status)===a.MESSAGE_STATUS.FAIL&&s.jsx("i",{className:"icon-fail"}),(null==c?void 0:c.status)===a.MESSAGE_STATUS.UNSEND&&s.jsx(r.Icon,{width:10,height:10,type:l.IconTypes.PROGRESS})]}))]}))}));exports.MessageBubble=function(t){return s.jsx(x,e.__assign({},t))};
