"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),n=require("react/jsx-runtime"),t=require("react"),o=require("tim-js-sdk"),r=require("../../context/TUIKitContext.js");require("../../context/TUIChatStateContext.js"),require("../../context/TUIChatActionContext.js"),require("../../context/TUIMessageContext.js"),require("../../context/ComponentContext.js"),require("../../context/TUIMessageInputContext.js");var i=require("./hooks/useConversationList.js"),s=require("../ConversationPreview/ConversationPreview.js");require("../ConversationPreview/ConversationPreviewContent.js"),require("../ConversationPreview/MyConversationPreviewContent.js");var a=require("../ConversationPreview/ConversationListContainer.js"),v=require("../Profile/Profile.js"),u=require("../ConversationSearch/ConversationSearchInput.js"),C=require("../ConversationSearch/ConversationSearchResult.js"),c=require("../ConversationCreate/ConversationCreate.js"),l=require("../Icon/Icon.js"),d=require("../Icon/type.js");require("../Input/Input.js"),require("../ConversationCreate/ConversationGroupTypeInfo.js");var j=require("../../context/TUIConversationContext.js"),f=require("../ConversationPreview/utils.js"),x=require("./hooks/useConversationUpdate.js");function h(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var p=h(t),I=h(o);function q(o){var h=o.Preview,p=o.Container,q=void 0===p?a.ConversationListContainer:p,P=o.onConversationListUpdated,w=o.filterConversation,g=o.showSelf,T=void 0===g||g,U=o.showSearch,_=void 0===U||U,m=o.onlyGroupConversation,L=void 0!==m&&m,S=o.onlyC2CConversation,y=void 0!==S&&S,N=o.setCurrentConversation,A=r.useTUIKitContext("TUIConversationList"),R=A.tim,E=A.customClasses,M=A.conversation,O=A.setActiveConversation,b=A.setTUIProfileShow,k=j.useTUIConversationContext("TUIConversationList").filterConversation,D=w||k,F=t.useState(0),G=F[0],K=F[1],V=i(R,(function(e,n){e.length&&O(M)}),D),Y=V.conversationList,z=V.setConversationList;x.useConversationUpdate(z,P,(function(){return K((function(e){return e+1}))}),D);var B=t.useState(""),H=B[0],J=B[1],Q=t.useState(Y),W=Q[0],X=Q[1],Z=t.useState(!1),$=Z[0],ee=Z[1],ne=r.useTUIKitContext().myProfile,te=t.useRef(null);return n.jsx("div",e.__assign({className:"tui-conversation ".concat(E||""),ref:te},{children:$?n.jsx(c.ConversationCreate,{conversationList:Y,setConversationCreated:ee}):n.jsxs(n.Fragment,{children:[T&&n.jsx(v.Profile,{profile:ne,handleAvatar:function(){b(!0)}}),_&&n.jsxs("div",e.__assign({className:"tui-conversation-header"},{children:[n.jsx(u.ConversationSearchInput,{value:H,clearable:!0,onChange:function(e){var n,t;if(J(null===(n=e.target)||void 0===n?void 0:n.value),null===(t=e.target)||void 0===t?void 0:t.value){var o=Y.filter((function(n){var t;return f.getDisplayTitle(n).toLocaleLowerCase().includes(null===(t=e.target)||void 0===t?void 0:t.value.toLocaleLowerCase())}));X(o)}else X([])}}),n.jsx("div",e.__assign({className:"tui-conversation-create-icon"},{children:n.jsx(l.Icon,{onClick:function(){J(""),ee(!0)},type:d.IconTypes.CREATE,height:24,width:24})}))]})),n.jsx(q,e.__assign({setConversationList:z},{children:0===Y.length?n.jsxs("div",e.__assign({className:"no-result"},{children:[n.jsx(l.Icon,{className:"no-result-icon",type:d.IconTypes.EFFORT,width:42,height:42}),n.jsx("div",e.__assign({className:"no-result-message"},{children:"No conversation"}))]})):H?n.jsx(C.ConversationSearchResult,{Preview:h,searchValue:H,result:W}):L?Y.filter((function(e){return e.type===I.default.TYPES.CONV_GROUP})).map((function(t){var o={activeConversation:M,conversation:t,setActiveConversation:O,Preview:h,conversationUpdateCount:G,setCurrentConversation:N};return n.jsx(s.ConversationPreview,e.__assign({},o),t.conversationID)})):y?Y.filter((function(e){return e.type===I.default.TYPES.CONV_C2C})).map((function(t){var o={activeConversation:M,conversation:t,setActiveConversation:O,Preview:h,conversationUpdateCount:G,setCurrentConversation:N};return n.jsx(s.ConversationPreview,e.__assign({},o),t.conversationID)})):Y.map((function(t){var o={activeConversation:M,conversation:t,setActiveConversation:O,Preview:h,conversationUpdateCount:G,setCurrentConversation:N};return n.jsx(s.ConversationPreview,e.__assign({},o),t.conversationID)}))}))]})}))}var P=p.default.memo(q);exports.TUIConversationList=P,exports.UnMemoTUIConversationList=q;
