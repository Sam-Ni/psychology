"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),t=require("react"),n=require("tim-js-sdk"),r=require("../../../context/TUIKitContext.js");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("../../../context/TUIChatStateContext.js"),require("../../../context/TUIChatActionContext.js"),require("../../../context/TUIMessageContext.js"),require("../../../context/ComponentContext.js"),require("../../../context/TUIMessageInputContext.js");var u=o(n);exports.useMyProfile=function(){var n=this,o=t.useState(null),i=o[0],a=o[1],s=r.useTUIKitContext("useMyProfile"),c=s.tim,l=s.myProfile,f=t.useCallback((function(){return e.__awaiter(n,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){switch(e.label){case 0:return l?(a(l),[3,3]):[3,1];case 1:return[4,null==c?void 0:c.getMyProfile()];case 2:t=e.sent(),a(null==t?void 0:t.data),e.label=3;case 3:return[2]}}))}))}),[c]),d=t.useCallback((function(t){return e.__awaiter(n,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(o){switch(o.label){case 0:return[4,null==c?void 0:c.updateMyProfile(t)];case 1:return n=o.sent(),r=e.__assign({},i),Object.keys(n.data).map((function(e){return r[e]=n.data[e],e})),a(r),[2,n]}}))}))}),[c]),_=function(e){console.log("onProfileUpdated",e.data)};return t.useEffect((function(){return e.__awaiter(n,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,f()];case 1:return e.sent(),[2]}}))})),null==c||c.on(u.default.EVENT.PROFILE_UPDATED,_),function(){null==c||c.off(u.default.EVENT.PROFILE_UPDATED,_)}}),[c]),{myProfile:i,updateMyProfile:d}};
