"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),t=require("react/jsx-runtime"),r=require("react"),n=require("../Input/Input.js"),s=require("../Icon/Icon.js"),a=require("../Icon/type.js"),i=require("./ConversationCreateSelectView.js"),c=require("../Avatar/Avatar.js"),o=require("../Avatar/default.js"),u=require("./hooks/useConversationCreate.js"),l=require("../../context/TUIKitContext.js");require("../../context/TUIChatStateContext.js"),require("../../context/TUIChatActionContext.js"),require("../../context/TUIMessageContext.js"),require("../../context/ComponentContext.js"),require("../../context/TUIMessageInputContext.js");var v=require("./ConversationCreate.js"),d=require("../../hooks/useConversation.js"),h=require("../Toast/index.js");exports.ConversationCreateUserSelectList=function(x){var p=this,C=x.isCreateGroup,j=x.selectList,_=x.setSelectList,g=x.className,f=x.conversationList,m=x.setIsCreateGroup,I=x.setConversationCreated,q=x.setPageState,N=r.useState(""),k=N[0],S=N[1],b=l.useTUIKitContext(),y=b.tim,T=b.setActiveConversation,A=r.useState({}),w=A[0],L=A[1],U=u.useConversationCreate(y,f,(function(e){L(e)})).getFriendListSortSearchResult,D=d.useConversation(y).createConversation,E=r.useRef(new Map);return t.jsxs(t.Fragment,{children:[t.jsx(n.Input,{className:"tui-conversation-create-search-input",placeholder:"Search",clearable:!0,value:k,onChange:function(t){return e.__awaiter(p,void 0,void 0,(function(){var r,n;return e.__generator(this,(function(e){switch(e.label){case 0:return r=t.target.value,S(r),n=L,[4,U(r)];case 1:return n.apply(void 0,[e.sent()]),[2]}}))}))},prefix:t.jsx(s.Icon,{type:a.IconTypes.SEARCH,height:16,width:16})}),C&&t.jsx(i.ConversationCreateSelectView,{selectList:j,setSelectList:_}),!C&&t.jsxs("div",e.__assign({role:"presentation",className:"tui-user",onClick:function(){m(!0),E.current.clear(),_([])}},{children:[t.jsx(s.Icon,{type:a.IconTypes.ADD}),t.jsx("div",e.__assign({className:"tui-user-name active"},{children:"New Group"}))]})),t.jsx("div",e.__assign({className:"tui-conversation-create ".concat(g)},{children:t.jsx("div",e.__assign({className:"tui-conversation-create-container"},{children:t.jsx("div",e.__assign({className:"tui-group-container"},{children:Object.keys(w).map((function(r){return 0!==w[r].length&&t.jsxs("div",e.__assign({className:"tui-group-box"},{children:[t.jsx("div",e.__assign({className:"title"},{children:r})),w[r].map((function(n,s){var a=n.userID,i=n.nick,u=n.avatar;return t.jsxs("label",e.__assign({role:"presentation",className:"tui-user tui-user-checkbox-label",htmlFor:"userChecked-".concat(r,"-").concat(a),onClick:function(t){!function(t){e.__awaiter(p,void 0,void 0,(function(){var r,n;return e.__generator(this,(function(e){switch(e.label){case 0:return C?[2]:(r=t.userID,[4,D("C2C".concat(r))]);case 1:return n=e.sent(),I(!1),T(n),[2]}}))}))}(n)}},{children:[t.jsx(c.Avatar,{size:30,image:u||o.defaultUserAvatar}),t.jsx("div",e.__assign({className:"tui-user-name"},{children:i||"".concat(a)})),C&&t.jsx("input",{onChange:function(t){!function(t,r,n){void 0===n&&(n=[]);var s=r.userID,a=t.target.checked;n.forEach((function(e){e.checked=a})),a?j.push({profile:r,domList:n}):j.splice(j.findIndex((function(e){return e.profile.userID===s})),1),_(e.__spreadArray([],j,!0))}(t,n,E.current.get(a))},type:"checkbox",ref:function(e){!function(e,t){if(t){E.current.has(e)||E.current.set(e,[]);var r=E.current.get(e);0!==r.length&&r.some((function(e){return e.id===t.id}))||r.push(t)}}(a,e)},id:"userChecked-".concat(r,"-").concat(a),className:"tui-user-checkbox"})]}),a)}))]}),r)}))}))}))})),C&&t.jsx("div",e.__assign({className:"tui-conversation-create-next-container"},{children:t.jsx("div",e.__assign({role:"presentation",className:"tui-conversation-create-next",onClick:function(){j&&0===j.length?h.Toast({text:"Participant cannot be empty.",type:"error"}):q(v.PageStateTypes.CREATE_DETAIL)}},{children:"Next"}))}))]})};
