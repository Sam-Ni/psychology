"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),r=require("react"),t=require("tim-js-sdk"),n=require("../static/word.js");require("../../../context/TUIConversationContext.js");var i=require("../../../hooks/useProfile.js");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=o(t);exports.useConversationCreate=function(t,o,s){var a=r.useState({}),c=a[0],f=a[1],d=function(e){var r=e.trim(),t=r.charCodeAt(0);return t>40869||t<19968?r.charAt(0):n.strChineseFirstPy.charAt(t-19968)},l=function(){return e.__awaiter(void 0,void 0,void 0,(function(){var r,n,i,a,c;return e.__generator(this,(function(e){switch(e.label){case 0:return r=o.filter((function(e){return e.type===u.default.TYPES.CONV_C2C})).slice(0,5).map((function(e){return e.userProfile})),[4,t.getFriendList()];case 1:return n=e.sent(),i=n.code,a=n.data,0===i&&(c=v(a.map((function(e){return e.profile})),r),f(c),s&&s(c,f)),[2]}}))}))},v=function(e,r){void 0===r&&(r=[]);for(var t={"Frequently Contacted":r,"#":[]},n=65;n<=90;n+=1)t[String.fromCharCode(n)]=[];return e.forEach((function(e){var r=e.nick,n=e.userID,i=d(r||n);i>="a"&&i<="z"?t[i.toLocaleUpperCase()].push(e):i<"A"||i>"z"?t["#"].push(e):t[i].push(e)})),Object.keys(t).forEach((function(e){t[e].sort((function(e,r){var t=e.nick,n=e.userID,i=r.nick,o=r.userID;return t||n<i||o||t||n===i||o?1:-1}))})),t},h=i.useProfile(t).getUserProfile;return r.useEffect((function(){l()}),[t]),{getFirstLetter:d,queryFriendList:l,getFriendListSortSearchResult:function(r){return e.__awaiter(void 0,void 0,void 0,(function(){var t,n,i,o;return e.__generator(this,(function(e){switch(e.label){case 0:return r?[4,h([r])]:[2,c];case 1:return t=e.sent().data,n={},i=!1,Object.keys(c).forEach((function(e){n[e]=c[e].filter((function(e){var t=e.nick,n=e.userID,o=t.toLocaleLowerCase(),u=r.toLocaleLowerCase(),s=o?o.includes(u):n.includes(u);return i=i||s,s}))})),"TencentCloudDemo"===(null===(o=process.env)||void 0===o?void 0:o.REACT_APP_ONLINE)?[2,n]:[2,i?n:v(t)]}}))}))},friendListSortResult:c}};
